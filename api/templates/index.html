{% load static %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Admin - Free Bulma template</title>
    <link rel="icon" href="{% static 'favicon.ico'%}">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
    <!-- Bulma Version 0.9.0-->
    <script src="http://127.0.0.1:8000/static/admin/js/vendor/jquery/jquery.js">
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.css"
    integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://unpkg.com/bulma@0.9.0/css/bulma.min.css" />
    <link rel="stylesheet" type="text/css" href="{% static 'style.css' %}">

</head>

<body>

  <!-- END NAV -->
    <div class="container">
        <div class="columns">
            <div class="column mt-3">

                <section class="hero is-info welcome is-small">
                    <div class="hero-body">
                        <div class="container">
                            <h1 class="title">
                                Berilgan ma'lumotlarni baholash
                            </h1>
                            <h2 class="subtitle">
                                Magisterlik dissertatsiyasi
                            </h2>
                        </div>
                    </div>
                </section>
                <div class="columns mt-3">
                    <div class="column is-6">
                        <div class="card events-card">
                          <form action="{% url 'index' %}" method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            <header class="card-header">
                                <p class="card-header-title">
                                    Events
                                </p>
                                <a href="#" class="card-header-icon" aria-label="more options">

                                </a>
                            </header>
                            <div class="card-table">
                                <div class="content">
                                    <table class="table is-fullwidth is-striped">
                                        <tbody class="tbody">
                                            <tr>
                                                <td width="5%"><i class="fas fa-file-excel"></i></td>
                                                <td id="file-name1">Faylni tanlang</td>
                                                <td class="level-right">
                                                  <input type="file" accept=".xls" name="my_file1" onchange="myfun(1);" id="my-file1" class="my-file">
                                                  <a class="button is-small is-primary" onclick="$('#my-file1').click();">Tanlash</a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td width="5%"><i class="fas fa-file-excel"></i></td>
                                                <td id="file-name2">Faylni tanlang</td>
                                                <td class="level-right">
                                                  <input type="file" accept=".xls" name="my_file2" id="my-file2" onchange="myfun(2)" class="my-file">
                                                  <a class="button is-small is-primary" onclick="$('#my-file2').click();">Tanlash</a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td width="5%"><i class="fas fa-file-excel"></i></td>
                                                <td id="file-name3">Faylni tanlang</td>
                                                <td class="level-right">
                                                  <input type="file" accept=".xls" name="my_file3" id="my-file3" onchange="myfun(3)" class="my-file">
                                                  <a class="button is-small is-primary" onclick="$('#my-file3').click();">Tanlash</a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td width="5%"><i class="fas fa-file-excel"></i></td>
                                                <td id="file-name4">Faylni tanlang</td>
                                                <td class="level-right">
                                                  <input type="file" accept=".xls" name="my_file4" id="my-file4" onchange="myfun(4)" class="my-file">
                                                  <a class="button is-small is-primary" onclick="$('#my-file4').click();">Tanlash</a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td width="5%"><i class="fas fa-file-excel"></i></td>
                                                <td id="file-name5">Faylni tanlang</td>
                                                <td class="level-right">
                                                  <input type="file" accept=".xls" name="my_file5" id="my-file5" onchange="myfun(5)" class="my-file">
                                                  <a class="button is-small is-primary" onclick="$('#my-file5').click();">Tanlash</a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <footer class="card-footer">
                                <div href="#" class="card-footer-item">
                                  <button type="button" id="mybutton" class="button is-primary"> + </button>
                                </div>
                                <div href="#" class="card-footer-item">
                                  <div><input  class="button is-primary" type="submit" onclick="particle()" value="Start"></div>
                                </div>
                            </footer>
                          </form>

                        </div>
                    </div>
                    <div class="column is-6">
                      <div class="has-text-centered" id="salom"></div>
                    </div>
                </div>
                {% if msg %}
                <div  id="app">
                  <div class="columns">
                    <div class="column" v-for="file1 in filename">
                      <div class="table tile has-text-centered is-flex">
                        <table class="box">
                          <tbody>
                            <tr>
                              <td>  File nomi: [[file1]]  </td>
                            </tr>
                          </tbody>
                          </table>
                      </div>
                    </div>
                </div>
                <div class="columns">
                    <div class="column" v-for="ms in msg">
                      <div class="table tile has-text-centered is-flex">
                        <table class="box">
                          <tbody v-for="list01 in ms">
                            <tr>
                              <td style="border: solid 2px #999; border-radius:10px">[[list01.sinf]]- sinf hatoligi [[list01.qiymat]] ga teng</td>
                            </tr>

                          </tbody>


                          </table>
                      </div>
                    </div>

                </div>
                <div class="columns">
                    <div class="column" v-for="lola in lolo">
                      <div class="table tile has-text-centered is-flex">
                        <table class="box">
                          <tbody>
                            <tr>
                              <td>O'rtacha xatoligi <br>[[lola]]</td>
                            </tr>
                          </tbody>
                          </table>
                      </div>
                    </div>
                </div>

              </div>
                {% endif %}

            </div>
        </div>



    <footer class="footer has-text-centered">Ikromov Shahobiddin (c) </footer>
  </div>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.js"></script>

    <script type="text/javascript" src="{% static '/all.js'%}"> </script>
    <script >
        particle=function(){

          var canvas = document.createElement('canvas'),
          ctx = canvas.getContext('2d'),
          w = canvas.width = 480,
          h = canvas.height = 350,
          particles = [],
          properties = {
              bgColor             : '#ffff',
              particleColor       : 'rgba(39, 52, 92)',
              particleRadius      : 5,
              particleCount       : 60,
              particleMaxVelocity : 10,
              lineLength          : 120,
              particleLife        : 6,
          };

          document.querySelector('#salom').appendChild(canvas);

          window.onresize = function(){
              w = canvas.width = 480,
              h = canvas.height = 350;
          }

          class Particle{
              constructor(){
                  this.x = Math.random()*w;
                  this.y = Math.random()*h;
                  this.velocityX = Math.random()*(properties.particleMaxVelocity*2)-properties.particleMaxVelocity;
                  this.velocityY = Math.random()*(properties.particleMaxVelocity*2)-properties.particleMaxVelocity;
                  this.life = Math.random()*properties.particleLife*60;
              }
              position(){
                  this.x + this.velocityX > w && this.velocityX > 0 || this.x + this.velocityX < 0 && this.velocityX < 0? this.velocityX*=-1 : this.velocityX;
                  this.y + this.velocityY > h && this.velocityY > 0 || this.y + this.velocityY < 0 && this.velocityY < 0? this.velocityY*=-1 : this.velocityY;
                  this.x += this.velocityX;
                  this.y += this.velocityY;
              }
              reDraw(){
                  ctx.beginPath();
                  ctx.arc(this.x, this.y, properties.particleRadius, 0, Math.PI*2);
                  ctx.closePath();
                  ctx.fillStyle = properties.particleColor;
                  ctx.fill();
              }
              reCalculateLife(){
                  if(this.life < 1){
                      this.x = Math.random()*w;
                      this.y = Math.random()*h;
                      this.velocityX = Math.random()*(properties.particleMaxVelocity*2)-properties.particleMaxVelocity;
                      this.velocityY = Math.random()*(properties.particleMaxVelocity*2)-properties.particleMaxVelocity;
                      this.life = Math.random()*properties.particleLife*60;
                  }
                  this.life--;
              }
          }

          function reDrawBackground(){
              ctx.fillStyle = properties.bgColor;
              ctx.fillRect(0, 0, w, h);
          }

          function drawLines(){
              var x1, y1, x2, y2, length, opacity;
              for(var i in particles){
                  for(var j in particles){
                      x1 = particles[i].x;
                      y1 = particles[i].y;
                      x2 = particles[j].x;
                      y2 = particles[j].y;
                      length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
                      if(length < properties.lineLength){
                          opacity = 1-length/properties.lineLength;
                          ctx.lineWidth = '0.5';
                          ctx.strokeStyle = 'rgba(50, 176, 201, '+opacity+')';
                          ctx.beginPath();
                          ctx.moveTo(x1, y1);
                          ctx.lineTo(x2, y2);
                          ctx.closePath();
                          ctx.stroke();
                      }
                  }
              }
          }

          function reDrawParticles(){
              for(var i in particles){
                  particles[i].reCalculateLife();
                  particles[i].position();
                  particles[i].reDraw();
              }
          }

          function loop(){
              reDrawBackground();
              reDrawParticles();
              drawLines();
              requestAnimationFrame(loop);
          }

          function init(){
              for(var i = 0 ; i < properties.particleCount ; i++){
                  particles.push(new Particle);
              }
              loop();
          }

          init();

      }

    </script>
    <script type="text/javascript" src="{% static 'vue.min.js' %}"> </script>
    {% if msg %}
    <script type="text/javascript">
      const app=new Vue({
        el:'#app',
        delimiters:['[[',']]'],
        data(){
          return {
            'msg':{{msg|safe}},
            'filename':{{filename|safe}},
            'lolo':{{lolo|safe}}
          }
        },
        methods:{
          winres(){
            if(this.msg){
              window.location.href='http://127.0.0.1:8000/'
            }
          }
        }
      })
    </script>
  {% endif %}
    <script>
      let nameNum = 6;
      document.getElementById('mybutton').addEventListener('click',()=>{
        document.querySelector('.tbody').innerHTML += `<tr>
            <td width="5%"><i class="fas fa-file-excel"></i></td>
            <td id="file-name${nameNum}">Choose file</td>
            <td class="level-right">
              <input  type="file" accept=".xls" name="my_file${nameNum}" id="my-file${nameNum}" onchange="myfun(${nameNum})" class="my-file">
              <a class="button is-small is-primary" onclick="$('#my-file${nameNum}').click();">Action</a>
            </td>
        </tr>`;
        nameNum += 1;
      })
      function myfun(id){
        let val=document.getElementById(`my-file${id}`).files[0].name;
        console.log(val);
        document.getElementById(`file-name${id}`).innerHTML=`${val}`
      }

    </script>
</body>

</html>
